{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.logout = exports.setProfile = exports.register = exports.login = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _axios = _interopRequireDefault(require(\"axios\"));\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar userState = {\n  token: '',\n  username: '',\n  password: '',\n  error: '',\n  loading: false,\n  status: false,\n  profile: {\n    address: '',\n    nickname: '',\n    tel: '',\n    email: '',\n    gender: null\n  }\n};\nvar LOGIN = 'user/LOGIN';\nvar LOGIN_SUCCESS = 'user/LOGIN_SUCCESS';\nvar LOGIN_ERROR = 'user/LOGIN_ERROR';\nvar REGISTER = 'user/REGISTER';\nvar REGISTER_SUCCESS = 'user/REGISTER_SUCCESS';\nvar REGISTER_ERROR = 'user/REGISTER_ERROR';\nvar SET_PROFILE = 'user/SET_PROFILE';\nvar LOGOUT = 'user/LOGOUT';\nvar LOGOUT_SUCCESS = 'user/LOGOUT_SUCCESS';\nvar LOGOUT_ERROR = 'user/LOGOUT_ERROR';\n\nvar login = function login(_ref) {\n  var username = _ref.username,\n      password = _ref.password;\n  return function _callee(dispatch) {\n    var _await$axios$post, _await$axios$post$dat, _profile, token;\n\n    return _regenerator.default.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            dispatch({\n              type: LOGIN\n            });\n            _context.prev = 1;\n            _context.next = 4;\n            return _regenerator.default.awrap(_axios.default.post('http://3.35.169.23:8000/account/auth/login/', {\n              username: username,\n              password: password\n            }));\n\n          case 4:\n            _await$axios$post = _context.sent;\n            _await$axios$post$dat = _await$axios$post.data;\n            _profile = _await$axios$post$dat.profile;\n            token = _await$axios$post$dat.token;\n            dispatch({\n              type: LOGIN_SUCCESS,\n              token: token,\n              profile: _profile\n            });\n            _context.next = 14;\n            break;\n\n          case 11:\n            _context.prev = 11;\n            _context.t0 = _context[\"catch\"](1);\n            dispatch({\n              type: LOGIN_ERROR,\n              error: _context.t0\n            });\n\n          case 14:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[1, 11]], Promise);\n  };\n};\n\nexports.login = login;\n\nvar register = function register(_ref2) {\n  var username = _ref2.username,\n      password = _ref2.password;\n  return function _callee2(dispatch) {\n    var _await$axios$post2, _await$axios$post2$da, _profile2, token;\n\n    return _regenerator.default.async(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            dispatch({\n              type: REGISTER\n            });\n            _context2.prev = 1;\n            _context2.next = 4;\n            return _regenerator.default.awrap(_axios.default.post('http://3.35.169.23:8000/account/auth/register/', {\n              username: username,\n              password: password\n            }));\n\n          case 4:\n            _await$axios$post2 = _context2.sent;\n            _await$axios$post2$da = _await$axios$post2.data;\n            _profile2 = _await$axios$post2$da.profile;\n            token = _await$axios$post2$da.token;\n            dispatch({\n              type: REGISTER_SUCCESS,\n              token: token,\n              profile: _profile2\n            });\n            _context2.next = 14;\n            break;\n\n          case 11:\n            _context2.prev = 11;\n            _context2.t0 = _context2[\"catch\"](1);\n            dispatch({\n              type: REGISTER_ERROR,\n              error: _context2.t0\n            });\n\n          case 14:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[1, 11]], Promise);\n  };\n};\n\nexports.register = register;\n\nvar setProfile = function setProfile(_ref3) {\n  var address = _ref3.address,\n      nickname = _ref3.nickname,\n      tel = _ref3.tel,\n      email = _ref3.email,\n      gender = _ref3.gender;\n  return {\n    type: SET_PROFILE,\n    body: {\n      address: address,\n      nickname: nickname,\n      tel: tel,\n      email: email,\n      gender: gender\n    }\n  };\n};\n\nexports.setProfile = setProfile;\n\nvar logout = function logout(_ref4) {\n  var token = _ref4.token;\n  return function _callee3(dispatch) {\n    return _regenerator.default.async(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            dispatch({\n              type: LOGOUT\n            });\n            _context3.prev = 1;\n            dispatch({\n              type: LOGOUT_SUCCESS\n            });\n            _context3.next = 5;\n            return _regenerator.default.awrap(_axios.default.post('http://3.35.169.23:8000/account/auth/logout/', {}, {\n              headers: {\n                Authorization: \"Token \" + token\n              }\n            }));\n\n          case 5:\n            _context3.next = 10;\n            break;\n\n          case 7:\n            _context3.prev = 7;\n            _context3.t0 = _context3[\"catch\"](1);\n            dispatch({\n              type: LOGOUT_ERROR,\n              error: _context3.t0\n            });\n\n          case 10:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[1, 7]], Promise);\n  };\n};\n\nexports.logout = logout;\n\nfunction userAuth() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : userState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case LOGIN:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        loading: true\n      });\n\n    case LOGIN_SUCCESS:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        token: action.token,\n        profile: action.profile,\n        status: true\n      });\n\n    case LOGIN_ERROR:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        error: action.error\n      });\n\n    case REGISTER:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        loading: true\n      });\n\n    case REGISTER_SUCCESS:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        profile: action.profile,\n        token: action.token\n      });\n\n    case SET_PROFILE:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        error: action.error\n      });\n\n    case LOGOUT:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        loading: true\n      });\n\n    case LOGOUT_SUCCESS:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        token: '',\n        status: false\n      });\n\n    case LOGOUT_ERROR:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        error: action.error\n      });\n\n    default:\n      return state;\n  }\n}\n\nvar _default = userAuth;\nexports.default = _default;","map":{"version":3,"sources":["C:/Users/rjqnr/src/planact/src/modules/userAuth.ts"],"names":["userState","token","username","password","error","loading","status","profile","address","nickname","tel","email","gender","LOGIN","LOGIN_SUCCESS","LOGIN_ERROR","REGISTER","REGISTER_SUCCESS","REGISTER_ERROR","SET_PROFILE","LOGOUT","LOGOUT_SUCCESS","LOGOUT_ERROR","login","dispatch","type","axios","post","data","register","setProfile","body","logout","headers","Authorization","userAuth","state","action"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\n\r\ntype profile = {\r\n  address: string\r\n  nickname: string\r\n  tel: string\r\n  email: string\r\n  gender: 'M' | 'F' | null\r\n}\r\n\r\n//초기 상태\r\ninterface userAuthProps {\r\n  loading: boolean\r\n  error: any\r\n  token: string\r\n  username: string\r\n  password: string\r\n  status: boolean\r\n  profile: profile\r\n}\r\n\r\nconst userState: userAuthProps = {\r\n  token: '',\r\n  username: '',\r\n  password: '',\r\n  error: '',\r\n  loading: false,\r\n  status: false,\r\n  profile: {\r\n    address: '',\r\n    nickname: '',\r\n    tel: '',\r\n    email: '',\r\n    gender: null,\r\n  },\r\n}\r\n\r\n//함수 인터페이스\r\ninterface loginOrRegisterProps {\r\n  username: string\r\n  password: string\r\n}\r\n\r\ninterface setProfileProps {\r\n  address: string\r\n  nickname: string\r\n  tel: string\r\n  email: string\r\n  gender: 'M' | 'F'\r\n}\r\n\r\ninterface logoutProps {\r\n  token: string\r\n}\r\n\r\n// 액션 타입\r\n\r\n// 로그인\r\nconst LOGIN = 'user/LOGIN'\r\nconst LOGIN_SUCCESS = 'user/LOGIN_SUCCESS'\r\nconst LOGIN_ERROR = 'user/LOGIN_ERROR'\r\n\r\nconst REGISTER = 'user/REGISTER'\r\nconst REGISTER_SUCCESS = 'user/REGISTER_SUCCESS'\r\nconst REGISTER_ERROR = 'user/REGISTER_ERROR'\r\n\r\nconst SET_PROFILE = 'user/SET_PROFILE'\r\n\r\nconst LOGOUT = 'user/LOGOUT'\r\nconst LOGOUT_SUCCESS = 'user/LOGOUT_SUCCESS'\r\nconst LOGOUT_ERROR = 'user/LOGOUT_ERROR'\r\n\r\n//액션 생성함수\r\nexport const login =\r\n  ({ username, password }: loginOrRegisterProps) =>\r\n  async (dispatch) => {\r\n    dispatch({ type: LOGIN })\r\n    try {\r\n      const {\r\n        data: { profile, token },\r\n      } = await axios.post('http://3.35.169.23:8000/account/auth/login/', {\r\n        username,\r\n        password,\r\n      })\r\n      dispatch({ type: LOGIN_SUCCESS, token, profile })\r\n    } catch (e) {\r\n      dispatch({ type: LOGIN_ERROR, error: e })\r\n    }\r\n  }\r\n\r\nexport const register =\r\n  ({ username, password }: loginOrRegisterProps) =>\r\n  async (dispatch) => {\r\n    dispatch({ type: REGISTER })\r\n    try {\r\n      const {\r\n        data: { profile, token },\r\n      } = await axios.post('http://3.35.169.23:8000/account/auth/register/', {\r\n        username,\r\n        password,\r\n      })\r\n      dispatch({ type: REGISTER_SUCCESS, token, profile })\r\n    } catch (e) {\r\n      dispatch({ type: REGISTER_ERROR, error: e })\r\n    }\r\n  }\r\n//prettier-ignore\r\nexport const setProfile = ({address, nickname,tel, email,gender}:setProfileProps) => ({\r\n  type: SET_PROFILE,\r\n  body:{\r\n    address,\r\n    nickname,\r\n    tel,\r\n    email,\r\n    gender\r\n  }\r\n})\r\n\r\nexport const logout =\r\n  ({ token }: logoutProps) =>\r\n  async (dispatch) => {\r\n    dispatch({ type: LOGOUT })\r\n    try {\r\n      dispatch({ type: LOGOUT_SUCCESS })\r\n      await axios.post(\r\n        'http://3.35.169.23:8000/account/auth/logout/',\r\n        {},\r\n        {\r\n          headers: {\r\n            //prettier-ignore\r\n            Authorization: `Token ${token}`,\r\n          },\r\n        }\r\n      )\r\n    } catch (e) {\r\n      dispatch({ type: LOGOUT_ERROR, error: e })\r\n    }\r\n  }\r\n\r\nfunction userAuth(state: userAuthProps = userState, action) {\r\n  switch (action.type) {\r\n    case LOGIN:\r\n      return {\r\n        ...state,\r\n        loading: true,\r\n      }\r\n    case LOGIN_SUCCESS:\r\n      return {\r\n        ...state,\r\n        token: action.token,\r\n        profile: action.profile,\r\n        status: true,\r\n      }\r\n    case LOGIN_ERROR:\r\n      return {\r\n        ...state,\r\n        error: action.error,\r\n      }\r\n    case REGISTER:\r\n      return {\r\n        ...state,\r\n        loading: true,\r\n      }\r\n    case REGISTER_SUCCESS:\r\n      return {\r\n        ...state,\r\n        profile: action.profile,\r\n        token: action.token,\r\n      }\r\n    case SET_PROFILE:\r\n      return {\r\n        ...state,\r\n        error: action.error,\r\n      }\r\n    case LOGOUT:\r\n      return {\r\n        ...state,\r\n        loading: true,\r\n      }\r\n    case LOGOUT_SUCCESS:\r\n      return {\r\n        ...state,\r\n        token: '',\r\n        status: false,\r\n      }\r\n    case LOGOUT_ERROR:\r\n      return { ...state, error: action.error }\r\n    default:\r\n      return state\r\n  }\r\n}\r\nexport default userAuth\r\n"]},"metadata":{},"sourceType":"script"}
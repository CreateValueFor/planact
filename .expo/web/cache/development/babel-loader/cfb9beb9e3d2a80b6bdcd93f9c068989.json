{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _objectDestructuringEmpty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectDestructuringEmpty\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _DailyList = _interopRequireDefault(require(\"../components/DailyList\"));\n\nvar _DailyView = _interopRequireDefault(require(\"../components/DailyView\"));\n\nvar _dayjs = _interopRequireDefault(require(\"dayjs\"));\n\nvar _reactNative = require(\"react-native\");\n\nvar _UserDailyData = require(\"../db/UserDailyData\");\n\nvar _jsxFileName = \"/Users/sooyoung/Projects/Planact/src/screens/Home.tsx\";\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction Home(_ref) {\n  (0, _objectDestructuringEmpty2.default)(_ref);\n  var user_id = \"111\";\n  var UNIT_FETCH_ONCE = 7;\n  var theme = (0, _reactRedux.useSelector)(function (_ref2) {\n    var theme = _ref2.theme;\n    return theme;\n  });\n\n  var _useState = (0, _react.useState)({\n    start: (0, _dayjs.default)(),\n    end: (0, _dayjs.default)().add(UNIT_FETCH_ONCE - 1, 'days'),\n    events: []\n  }),\n      _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n      dailylist = _useState2[0],\n      setDailylist = _useState2[1];\n\n  var start = dailylist.start,\n      end = dailylist.end,\n      events = dailylist.events;\n\n  var loadAfterData = function loadAfterData() {\n    var newStart, newEnd, newDailyListData;\n    return _regenerator.default.async(function loadAfterData$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            newStart = end.add(1, 'days');\n            newEnd = end.add(UNIT_FETCH_ONCE, 'days');\n            _context.next = 4;\n            return _regenerator.default.awrap((0, _UserDailyData.getDailyList)({\n              user_id: user_id,\n              start: newStart,\n              end: newEnd\n            }));\n\n          case 4:\n            newDailyListData = _context.sent;\n            console.log(dailylist);\n            console.log(newDailyListData);\n            setDailylist({\n              start: start,\n              end: newEnd,\n              events: [].concat((0, _toConsumableArray2.default)(events), (0, _toConsumableArray2.default)(newDailyListData.events))\n            });\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var loadBeforeData = function loadBeforeData() {\n    var newStart, newEnd, newDailyListData;\n    return _regenerator.default.async(function loadBeforeData$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            newStart = start.subtract(1, 'days');\n            newEnd = start.subtract(UNIT_FETCH_ONCE, 'days');\n            _context2.next = 4;\n            return _regenerator.default.awrap((0, _UserDailyData.getDailyList)({\n              user_id: user_id,\n              start: newStart,\n              end: newEnd\n            }));\n\n          case 4:\n            newDailyListData = _context2.sent;\n            setDailylist({\n              start: newStart,\n              end: end,\n              events: [].concat((0, _toConsumableArray2.default)(newDailyListData.events), (0, _toConsumableArray2.default)(events))\n            });\n\n          case 6:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var loader = function loader(after) {\n    return after ? loadAfterData : loadBeforeData;\n  };\n\n  (0, _react.useEffect)(function () {\n    (function _callee() {\n      var newDailyListData;\n      return _regenerator.default.async(function _callee$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return _regenerator.default.awrap((0, _UserDailyData.getDailyList)({\n                user_id: user_id,\n                start: start,\n                end: end\n              }));\n\n            case 2:\n              newDailyListData = _context3.sent;\n              setDailylist(function (prev) {\n                return _objectSpread(_objectSpread({}, prev), {}, {\n                  events: newDailyListData.events\n                });\n              });\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, []);\n  return _react.default.createElement(_reactNative.SafeAreaView, {\n    style: styles(theme).container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  }, _react.default.createElement(_reactNative.View, {\n    style: {\n      minHeight: 130\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 13\n    }\n  }, _react.default.createElement(_DailyList.default, (0, _extends2.default)({}, dailylist, {\n    loader: loader,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 17\n    }\n  }))), _react.default.createElement(_reactNative.View, {\n    style: {\n      flex: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 13\n    }\n  }, _react.default.createElement(_DailyView.default, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 17\n    }\n  })));\n}\n\nvar styles = function styles(theme) {\n  return _reactNative.StyleSheet.create({\n    container: {\n      flex: 1,\n      alignItems: \"stretch\",\n      backgroundColor: theme.mainBackground\n    }\n  });\n};\n\nvar _default = Home;\nexports.default = _default;","map":{"version":3,"sources":["/Users/sooyoung/Projects/Planact/src/screens/Home.tsx"],"names":["Home","user_id","UNIT_FETCH_ONCE","theme","start","end","add","events","dailylist","setDailylist","loadAfterData","newStart","newEnd","newDailyListData","console","log","loadBeforeData","subtract","loader","after","prev","styles","container","minHeight","flex","StyleSheet","create","alignItems","backgroundColor","mainBackground"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport {  GlobalState } from \"@/../App\";\nimport DailyList from \"@/components/DailyList\";\nimport DailyView from \"@/components/DailyView\";\nimport { DefaultTheme } from \"@/style/styled\";\nimport { DailyListProps, User_Event } from \"@/utils/data\";\nimport dayjs, { Dayjs } from \"dayjs\";\nimport { SafeAreaView, View, StyleSheet } from \"react-native\";\nimport { useEffect } from \"react\";\nimport { getDailyList } from \"@/db/UserDailyData\";\n\nexport interface HomeProps{\n\n}\n\n\nfunction Home({}:HomeProps){\n    const user_id=\"111\";\n\n    // 1회당 가져올 날짜 수\n    const UNIT_FETCH_ONCE = 7;\n\n    const theme = useSelector(({theme}:GlobalState) => theme);\n    const [dailylist, setDailylist] = useState<DailyListProps>({\n        start: dayjs(),\n        end: dayjs().add(UNIT_FETCH_ONCE-1, 'days'),\n        events: []\n    });\n    const {start, end, events} = dailylist;\n    // 7일치 데이터\n    const loadAfterData = async () => {\n        const newStart = end.add(1, 'days');\n        const newEnd = end.add(UNIT_FETCH_ONCE, 'days');\n        const newDailyListData:DailyListProps = await getDailyList({user_id, start: newStart, end:newEnd});\n        console.log(dailylist);\n        console.log(newDailyListData);\n        setDailylist({\n            start,\n            end: newEnd,\n            // events: [...events, ...newDailyListData.events]\n            events: [...events, ...newDailyListData.events]\n        });\n    }\n    const loadBeforeData = async () => {\n        const newStart = start.subtract(1, 'days');\n        const newEnd = start.subtract(UNIT_FETCH_ONCE, 'days')\n        const newDailyListData:DailyListProps = await getDailyList({user_id, start: newStart, end:newEnd});\n        setDailylist({\n            start: newStart,\n            end,\n            events: [...newDailyListData.events, ...events]\n        });\n    }\n    const loader = (after:boolean) => after ? loadAfterData : loadBeforeData;\n    \n    useEffect(() => {\n        (async () => {\n            const newDailyListData:DailyListProps = await getDailyList({user_id, start, end});\n            setDailylist( prev => ({...prev, events:newDailyListData.events}));\n        })();\n    },[])\n\n    return(\n        <SafeAreaView style={styles(theme).container}>\n            <View style={{minHeight:130}}>\n                <DailyList \n                    {...dailylist} \n                    loader={loader}\n                />\n            </View>\n            <View style={{flex:1}}>\n                <DailyView />\n            </View>\n        </SafeAreaView>\n    )\n}\n\nconst styles = (theme:DefaultTheme) => StyleSheet.create({\n    container: {\n      flex: 1,\n      alignItems:\"stretch\",\n      backgroundColor: theme.mainBackground,\n    },\n});\n\nexport default Home;"]},"metadata":{},"sourceType":"script"}